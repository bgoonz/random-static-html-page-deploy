<!DOCTYPE html><html lang="en"><head><script>window.currentUser = null;</script><script>window.rateUsdToNative = 1;</script><title itemprop="name">Custom elements</title><link href="/pack/styles.d6e712fda8b9d95f7338.css" rel="stylesheet"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, minimum-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><script>if (window.devicePixelRatio > 1) document.cookie = 'pixelRatio=' + window.devicePixelRatio + ';path=/;expires=Tue, 19 Jan 2038 03:14:07 GMT';</script><link href="//fonts.googleapis.com/css?family=Open+Sans:bold,italic,bolditalic" rel="stylesheet"><link rel="apple-touch-icon-precomposed" href="/img/favicon/apple-touch-icon-precomposed.png"><link rel="canonical" href="https://javascript.info/custom-elements"><meta name="msapplication-TileColor" content="#222A2C"><meta name="msapplication-TileImage" content="/img/favicon/tileicon.png"><link rel="icon" href="/img/favicon/favicon.png"><meta itemprop="image" content="https://javascript.info/img/site_preview_en_512x512.png"><meta property="og:title" content="Custom elements"><meta property="og:image" content="https://javascript.info/img/site_preview_en_1200x630.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="fb:admins" content="100001562528165"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Custom elements"><meta name="twitter:site" content="@iliakan"><meta name="twitter:creator" content="@iliakan"><meta name="twitter:image" content="https://javascript.info/img/site_preview_en_512x512.png"><link rel="prev" href="/webcomponents-intro"><link rel="next" href="/shadow-dom"><script>window.GA_ID = "UA-2056213-15";</script><script>window.YANDEX_METRIKA_ID = 32184394;</script><script>window.GoogleAnalyticsObject="ga",window.ga=function(){window.ga.q.push(arguments)},window.ga.q=[],window.ga.l=Date.now(),ga("create",GA_ID,"auto"),window.GTM_ID&&ga("require",GTM_ID),window.currentUser?ga("set","&uid",currentUser.id):ga("set","anonymizeIp",!0),window.addEventListener("error",function(e){var r=(e.filename||e.errorUrl)+": "+(e.lineno||e.errorLine),n=e.stack||e.error&&e.error.stack;ga("send","exception",{exDescription:e.message+" "+r+" "+n,exFatal:!0})});</script><script src="https://www.google-analytics.com/analytics.js" async></script><script>ga('send', 'pageview');</script><script>window.metrika={reachGoal:function(){}},window.yandex_metrika_callbacks=[function(){try{window.metrika=new Ya.Metrika({id:YANDEX_METRIKA_ID,webvisor:!0,clickmap:!0,params:{user:window.currentUser&&window.currentUser.id}}),metrika.trackLinks({delay:150}),window.addEventListener("error",function(r){window.metrika.reachGoal("JSERROR",{src:(r.filename||r.errorUrl)+": "+(r.lineno||r.errorLine),stack:r.stack||r.error&&r.error.stack,message:r.message})})}catch(r){}}];</script><script src="//mc.yandex.ru/metrika/watch.js" async></script><script>window.RECAPTCHA_ID = "6LfmLAEVAAAAAJMykMnf7aY8nkyTRmYi2ynx51R1";</script><script src="/pack/init.51e39bc929812b94c4a8.js"></script><script src="/pack/head.7a1dfd85e1f5c29a4840.js" defer></script><script>
  /*
class TimeFormatted extends HTMLElement {

  render() {
    let date = new Date(this.getAttribute('datetime') || Date.now());

    this.innerHTML = new Intl.DateTimeFormat("default", {
      year: this.getAttribute('year') || undefined,
      month: this.getAttribute('month') || undefined,
      day: this.getAttribute('day') || undefined,
      hour: this.getAttribute('hour') || undefined,
      minute: this.getAttribute('minute') || undefined,
      second: this.getAttribute('second') || undefined,
      timeZoneName: this.getAttribute('time-zone-name') || undefined,
    }).format(date);
  }

  connectedCallback() { // (2)
    if (!this.rendered) {
      this.render();
      this.rendered = true;
    }
  }

  static get observedAttributes() { // (3)
    return ['datetime', 'year', 'month', 'day', 'hour', 'minute', 'second', 'time-zone-name'];
  }

  attributeChangedCallback(name, oldValue, newValue) { // (4)
    this.render();
  }

}

window.customElements && customElements.define("time-formatted", TimeFormatted);
*/
</script>
<meta property="og:title" content="Custom elements"><meta property="og:type" content="article"><script src="/pack/tutorial.a2cb726ed10a7d440094.js" defer></script><script src="/pack/footer.2786f555ff370bdde300.js" defer></script></head><body class="no-icons"><script>window.fontTest();</script><div class="page-wrapper page-wrapper_sidebar_on"><!--[if IE]><div style="color:red;text-align:center">Sorry, Internet Explorer is not supported, please use a newer browser.</div><![endif]--><div class="sitetoolbar sitetoolbar_tutorial"><script>window.langs = [{"code":"ar","name":"Arabic"},{"code":"az","name":"Azerbaijani"},{"code":"bg","name":"Bulgarian"},{"code":"bn","name":"Bengali"},{"code":"ca","name":"Catalan"},{"code":"cs","name":"Czech"},{"code":"da","name":"Danish"},{"code":"de","name":"German"},{"code":"el","name":"Greek"},{"code":"en","name":"English"},{"code":"es","name":"Spanish"},{"code":"fa","name":"Persian (Farsi)"},{"code":"fi","name":"Finnish"},{"code":"fr","name":"French"},{"code":"he","name":"Hebrew"},{"code":"hi","name":"Hindi"},{"code":"hr","name":"Croatian"},{"code":"hu","name":"Hungarian"},{"code":"hy","name":"Armenian"},{"code":"id","name":"Indonesian"},{"code":"it","name":"Italian"},{"code":"ja","name":"Japanese"},{"code":"ka","name":"Georgian"},{"code":"kk","name":"Kazakh"},{"code":"km","name":"Central Khmer"},{"code":"ko","name":"Korean"},{"code":"lt","name":"Lithuanian"},{"code":"me","name":"Montenegrin"},{"code":"ml","name":"Malayalam"},{"code":"my","name":"Burmese"},{"code":"nl","name":"Dutch"},{"code":"no","name":"Norvegian"},{"code":"pa","name":"Punjabi"},{"code":"pl","name":"Polish"},{"code":"pt","name":"Portuguese"},{"code":"ro","name":"Romanian"},{"code":"ru","name":"Russian"},{"code":"si","name":"Sinhala"},{"code":"sk","name":"Slovak"},{"code":"sl","name":"Slovenian"},{"code":"sq","name":"Albanian"},{"code":"sr","name":"Serbian"},{"code":"ta","name":"Tamil"},{"code":"te","name":"Telugu"},{"code":"test","name":"Test"},{"code":"th","name":"Thai"},{"code":"tk","name":"Turkmen"},{"code":"tr","name":"Turkish"},{"code":"uk","name":"Ukrainian"},{"code":"ur","name":"Urdu"},{"code":"uz","name":"Uzbek"},{"code":"v2","name":"v2"},{"code":"vi","name":"Vietnamese"},{"code":"zh-hant","name":"Chinese Traditional"},{"code":"zh","name":"Chinese"}];</script><script>window.lang = "en";</script><script>{let t=navigator.languages||[];t=t.map(t=>t.toLowerCase());let o,i,n=[];for(let o of window.langs)for(let i of t)if(i===o.code||i.startsWith(o.code+"-")){n.push(o);break}if("en"===lang)o='\n      We created a Discord chat channel :), <a href="https://discord.gg/DT2QwadzJR">click here to join</a>.\n    ',i="notify-discord";else if("ru"!=lang){n.find(t=>"en"==t.code)&&(o=`\n            According to your browser headers, you know English. Please help to <a href="https://github.com/javascript-tutorial/${lang}.javascript.info#readme">translate the tutorial</a>.\n            Thank you!\n          `,i="notify-translate-tutorial-local")}if(o){let t=`<div class="notification notification_top notification_info sitetoolbar__notification" style="display:none" id="${i}">\n          <div class="notification__content">${o}</div>\n          <button class="notification__close" title="Close"></button>\n        </div>`;document.write(t),showTopNotification()}}</script><div class="sitetoolbar__content"><div class="sitetoolbar__lang-switcher"><button class="sitetoolbar__dropdown-button" data-dropdown-toggler>EN</button><div class="sitetoolbar__dropdown-wrap"><div class="sitetoolbar__dropdown-body"><div class="sitetoolbar__lang-switcher-body"><div class="supported-langs supported-langs_toolbar"><div class="supported-langs__container"><ul class="supported-langs__list" style="height:200px"><li class="supported-langs__item"><a class="supported-langs__link" href="https://ar.javascript.info/"><span class="supported-langs__brief">AR</span><span class="supported-langs__title">عربي</span></a></li><li class="supported-langs__item supported-langs__item_current"><a class="supported-langs__link" href="https://javascript.info/custom-elements"><span class="supported-langs__brief">EN</span><span class="supported-langs__title">English</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://es.javascript.info/custom-elements"><span class="supported-langs__brief">ES</span><span class="supported-langs__title">Español</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://fr.javascript.info/custom-elements"><span class="supported-langs__brief">FR</span><span class="supported-langs__title">Français</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://id.javascript.info/custom-elements"><span class="supported-langs__brief">ID</span><span class="supported-langs__title">Indonesia</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://it.javascript.info/custom-elements"><span class="supported-langs__brief">IT</span><span class="supported-langs__title">Italiano</span></a></li></ul><ul class="supported-langs__list" style="height:164px"><li class="supported-langs__item"><a class="supported-langs__link" href="https://ja.javascript.info/custom-elements"><span class="supported-langs__brief">JA</span><span class="supported-langs__title">日本語</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://ko.javascript.info/"><span class="supported-langs__brief">KO</span><span class="supported-langs__title">한국어</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://learn.javascript.ru/custom-elements"><span class="supported-langs__brief">RU</span><span class="supported-langs__title">Русский</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://tr.javascript.info/custom-elements"><span class="supported-langs__brief">TR</span><span class="supported-langs__title">Türkçe</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://zh.javascript.info/custom-elements"><span class="supported-langs__brief">ZH</span><span class="supported-langs__title">简体中文</span></a></li></ul></div><div class="supported-langs__text"><p>We want to make this open-source project available for people all around the world.</p> <p><a href="https://javascript.info/translate">Help to translate</a> the content of this tutorial to your language!</p>
</div></div></div></div></div></div><div class="sitetoolbar__logo-wrap"><a class="sitetoolbar__link sitetoolbar__link_logo" href="/"><img class="sitetoolbar__logo sitetoolbar__logo_normal" src="/img/sitetoolbar__logo_en.svg" width="200" alt="" role="presentation"/><img class="sitetoolbar__logo sitetoolbar__logo_small" src="/img/sitetoolbar__logo_small_en.svg" width="70" alt="" role="presentation"/><script>Array.prototype.forEach.call(document.querySelectorAll("img.sitetoolbar__logo"),function(e){let t=document.createElement("object");t.type="image/svg+xml",t.className=e.className,t.style.cssText="left:0;top:0;position:absolute",t.onload=function(){t.onload=null,e.style.visibility="hidden"},t.data=e.src,e.parentNode.insertBefore(t,e)});</script></a></div><div class="sitetoolbar__nav-toggle-wrap"><button class="sitetoolbar__nav-toggle" type="button"></button></div><nav class="sitetoolbar__sections"><ul class="sitetoolbar__sections-list"></ul></nav><div class="sitetoolbar__book-wrap"><a class="buy-book-button" href="/ebook"><span class="buy-book-button__extra-text">Buy</span>EPUB/PDF</a></div><div class="sitetoolbar__login-wrap"><button class="sitetoolbar__login sitetoolbar__login_unready" data-action-login></button></div><div class="sitetoolbar__search-wrap"><div class="sitetoolbar__search-content"><form class="sitetoolbar__search" method="GET" action="/search"><button class="sitetoolbar__search-toggle" type="button"></button><div class="sitetoolbar__search-input"><div class="text-input"><input class="text-input__control" name="query" placeholder="Search on Javascript.info" required="required" type="text"/></div><button class="sitetoolbar__find" type="submit">Search</button></div></form></div></div></div><div class="tablet-menu"><div class="tablet-menu__line"><div class="tablet-menu__content"><form class="tablet-menu-search" action="/search/"><input class="tablet-menu-search__input" type="search" name="query" placeholder="Search in the tutorial" required="required"/><button class="tablet-menu-search__button" type="submit" name="type" value="articles">Search</button></form></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><a class="map" href="/tutorial/map" data-action="tutorial-map"><span class="map__text">Tutorial map</span></a></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><div class="share-icons"><span class="share-icons__title">Share</span><a class="share share_tw" href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fcustom-elements" rel="nofollow"></a><a class="share share_fb" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjavascript.info%2Fcustom-elements" rel="nofollow"></a></div></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><select class="tablet-menu__nav input-select input-select input-select_small" onchange="if(this.value) window.location.href=this.value"><option value="https://ar.javascript.info/">عربي</option><option value="https://javascript.info/custom-elements" selected>English</option><option value="https://es.javascript.info/custom-elements">Español</option><option value="https://fr.javascript.info/custom-elements">Français</option><option value="https://id.javascript.info/custom-elements">Indonesia</option><option value="https://it.javascript.info/custom-elements">Italiano</option><option value="https://ja.javascript.info/custom-elements">日本語</option><option value="https://ko.javascript.info/">한국어</option><option value="https://learn.javascript.ru/custom-elements">Русский</option><option value="https://tr.javascript.info/custom-elements">Türkçe</option><option value="https://zh.javascript.info/custom-elements">简体中文</option></select></div></div></div><progress class="tutorial-progress" data-sticky value="2" max="7" data-tooltip="Lesson 2 of 7"></progress></div><div class="page page_sidebar_on page_inner_padding"><script>if(localStorage.noSidebar){document.querySelector(".page").classList.remove("page_sidebar_on");let e=document.querySelector(".page-wrapper");e&&e.classList.remove("page-wrapper_sidebar_on")}setTimeout(function(){document.querySelector(".page").classList.add("page_sidebar-animation-on")});</script><div class="page__inner"><main class="main main_width-limit"><header class="main__header"><div class="main__header-inner"><div class="main__header-group"><ol class="breadcrumbs"><li class="breadcrumbs__item breadcrumbs__item_home"><a class="breadcrumbs__link" href="/"><span class="breadcrumbs__hidden-text">Tutorial</span></a></li><li class="breadcrumbs__item" id="breadcrumb-1"><a class="breadcrumbs__link" href="/web-components"><span>Web components</span></a></li><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Tutorial","item":"https://javascript.info/"},{"@type":"ListItem","position":2,"name":"Web components","item":"https://javascript.info/web-components"}]}</script></ol><div class="updated-at" data-tooltip="Last updated at 26th March 2021"><div class="updated-at__content">26th March 2021</div></div></div><h1 class="main__header-title">Custom elements</h1></div></header><div class="content"><article class="formatted" itemscope itemtype="http://schema.org/TechArticle"><meta itemprop="name" content="Custom elements"><div itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="email" content="iliakan@gmail.com"><meta itemprop="name" content="Ilya Kantor"></div><div itemprop="articleBody"><p>We can create custom HTML elements, described by our class, with its own methods and properties, events and so on.</p>
<p>Once a custom element is defined, we can use it on par with built-in HTML elements.</p>
<p>That’s great, as HTML dictionary is rich, but not infinite. There are no <code>&lt;easy-tabs&gt;</code>, <code>&lt;sliding-carousel&gt;</code>, <code>&lt;beautiful-upload&gt;</code>… Just think of any other tag we might need.</p>
<p>We can define them with a special class, and then use as if they were always a part of HTML.</p>
<p>There are two kinds of custom elements:</p>
<ol>
<li><strong>Autonomous custom elements</strong> – “all-new” elements, extending the abstract <code>HTMLElement</code> class.</li>
<li><strong>Customized built-in elements</strong> – extending built-in elements, like a customized button, based on <code>HTMLButtonElement</code> etc.</li>
</ol>
<p>First we’ll cover autonomous elements, and then move to customized built-in ones.</p>
<p>To create a custom element, we need to tell the browser several details about it: how to show it, what to do when the element is added or removed to page, etc.</p>
<p>That’s done by making a class with special methods. That’s easy, as there are only few methods, and all of them are optional.</p>
<p>Here’s a sketch with the full list:</p>
<div id="fokuom5msm" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>class MyElement extends HTMLElement {
  constructor() {
    super();
    // element created
  }

  connectedCallback() {
    // browser calls this method when the element is added to the document
    // (can be called many times if an element is repeatedly added/removed)
  }

  disconnectedCallback() {
    // browser calls this method when the element is removed from the document
    // (can be called many times if an element is repeatedly added/removed)
  }

  static get observedAttributes() {
    return [/* array of attribute names to monitor for changes */];
  }

  attributeChangedCallback(name, oldValue, newValue) {
    // called when one of attributes listed above is modified
  }

  adoptedCallback() {
    // called when the element is moved to a new document
    // (happens in document.adoptNode, very rarely used)
  }

  // there can be other element methods and properties
}</code></pre>
        </div>
      </div>
      
      </div><p>After that, we need to register the element:</p>
<div id="rikx461x6l" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>// let the browser know that &lt;my-element&gt; is served by our new class
customElements.define(&quot;my-element&quot;, MyElement);</code></pre>
        </div>
      </div>
      
      </div><p>Now for any HTML elements with tag <code>&lt;my-element&gt;</code>, an instance of <code>MyElement</code> is created, and the aforementioned methods are called. We also can <code>document.createElement('my-element')</code> in JavaScript.</p>
<div class="important important_smart">
            <div class="important__header"><span class="important__type">Custom element name must contain a hyphen <code>-</code></span></div>
            <div class="important__content"><p>Custom element name must have a hyphen <code>-</code>, e.g. <code>my-element</code> and <code>super-button</code> are valid names, but <code>myelement</code> is not.</p>
<p>That’s to ensure that there are no name conflicts between built-in and custom HTML elements.</p>
</div></div>
<h2><a class="main__anchor" name="example-time-formatted" href="#example-time-formatted">Example: “time-formatted”</a></h2><p>For example, there already exists <code>&lt;time&gt;</code> element in HTML, for date/time. But it doesn’t do any formatting by itself.</p>
<p>Let’s create <code>&lt;time-formatted&gt;</code> element that displays the time in a nice, language-aware format:</p>
<div id="44xhmtsnv1" data-trusted="1" class="code-example" data-demo-height="50" data-highlight="[{&quot;start&quot;:23,&quot;end&quot;:23},{&quot;start&quot;:19,&quot;end&quot;:19},{&quot;start&quot;:1,&quot;end&quot;:1}]" data-autorun="no-epub">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code>&lt;script&gt;
class TimeFormatted extends HTMLElement { // (1)

  connectedCallback() {
    let date = new Date(this.getAttribute('datetime') || Date.now());

    this.innerHTML = new Intl.DateTimeFormat(&quot;default&quot;, {
      year: this.getAttribute('year') || undefined,
      month: this.getAttribute('month') || undefined,
      day: this.getAttribute('day') || undefined,
      hour: this.getAttribute('hour') || undefined,
      minute: this.getAttribute('minute') || undefined,
      second: this.getAttribute('second') || undefined,
      timeZoneName: this.getAttribute('time-zone-name') || undefined,
    }).format(date);
  }

}

customElements.define(&quot;time-formatted&quot;, TimeFormatted); // (2)
&lt;/script&gt;

&lt;!-- (3) --&gt;
&lt;time-formatted datetime=&quot;2019-12-01&quot;
  year=&quot;numeric&quot; month=&quot;long&quot; day=&quot;numeric&quot;
  hour=&quot;numeric&quot; minute=&quot;numeric&quot; second=&quot;numeric&quot;
  time-zone-name=&quot;short&quot;
&gt;&lt;/time-formatted&gt;</code></pre>
        </div>
      </div>
      <div class="code-result code-example__result">
          <iframe
            class="code-result__iframe"
            name="test-44xhmtsnv1"
            style="height:50px"
            src="about:blank"></iframe>
        </div>
      </div><ol>
<li>The class has only one method <code>connectedCallback()</code> – the browser calls it when <code>&lt;time-formatted&gt;</code> element is added to page (or when HTML parser detects it), and it uses the built-in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat">Intl.DateTimeFormat</a> data formatter, well-supported across the browsers, to show a nicely formatted time.</li>
<li>We need to register our new element by <code>customElements.define(tag, class)</code>.</li>
<li>And then we can use it everywhere.</li>
</ol>
<div class="important important_smart">
            <div class="important__header"><span class="important__type">Custom elements upgrade</span></div>
            <div class="important__content"><p>If the browser encounters any <code>&lt;time-formatted&gt;</code> elements before <code>customElements.define</code>, that’s not an error. But the element is yet unknown, just like any non-standard tag.</p>
<p>Such “undefined” elements can be styled with CSS selector <code>:not(:defined)</code>.</p>
<p>When <code>customElement.define</code> is called, they are “upgraded”: a new instance of <code>TimeFormatted</code>
is created for each, and <code>connectedCallback</code> is called. They become <code>:defined</code>.</p>
<p>To get the information about custom elements, there are methods:</p>
<ul>
<li><code>customElements.get(name)</code> – returns the class for a custom element with the given <code>name</code>,</li>
<li><code>customElements.whenDefined(name)</code> – returns a promise that resolves (without value) when a custom element with the given <code>name</code> becomes defined.</li>
</ul>
</div></div>
<div class="important important_smart">
            <div class="important__header"><span class="important__type">Rendering in <code>connectedCallback</code>, not in <code>constructor</code></span></div>
            <div class="important__content"><p>In the example above, element content is rendered (created) in <code>connectedCallback</code>.</p>
<p>Why not in the <code>constructor</code>?</p>
<p>The reason is simple: when <code>constructor</code> is called, it’s yet too early. The element is created, but the browser did not yet process/assign attributes at this stage: calls to <code>getAttribute</code> would return <code>null</code>. So we can’t really render there.</p>
<p>Besides, if you think about it, that’s better performance-wise – to delay the work until it’s really needed.</p>
<p>The <code>connectedCallback</code> triggers when the element is added to the document. Not just appended to another element as a child, but actually becomes a part of the page. So we can build detached DOM, create elements and prepare them for later use. They will only be actually rendered when they make it into the page.</p>
</div></div>
<h2><a class="main__anchor" name="observing-attributes" href="#observing-attributes">Observing attributes</a></h2><p>In the current implementation of <code>&lt;time-formatted&gt;</code>, after the element is rendered, further attribute changes don’t have any effect. That’s strange for an HTML element. Usually, when we change an attribute, like <code>a.href</code>, we expect the change to be immediately visible. So let’s fix this.</p>
<p>We can observe attributes by providing their list in <code>observedAttributes()</code> static getter. For such attributes, <code>attributeChangedCallback</code> is called when they are modified. It doesn’t trigger for other, unlisted attributes (that’s for performance reasons).</p>
<p>Here’s a new <code>&lt;time-formatted&gt;</code>, that auto-updates when attributes change:</p>
<div id="i4bsed8gfk" data-trusted="1" class="code-example" data-demo-height="50" data-highlight="[{&quot;start&quot;:40,&quot;end&quot;:40},{&quot;start&quot;:28,&quot;end&quot;:28},{&quot;start&quot;:24,&quot;end&quot;:24},{&quot;start&quot;:17,&quot;end&quot;:17},{&quot;start&quot;:3,&quot;end&quot;:3}]" data-autorun="no-epub">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code>&lt;script&gt;
class TimeFormatted extends HTMLElement {

  render() { // (1)
    let date = new Date(this.getAttribute('datetime') || Date.now());

    this.innerHTML = new Intl.DateTimeFormat(&quot;default&quot;, {
      year: this.getAttribute('year') || undefined,
      month: this.getAttribute('month') || undefined,
      day: this.getAttribute('day') || undefined,
      hour: this.getAttribute('hour') || undefined,
      minute: this.getAttribute('minute') || undefined,
      second: this.getAttribute('second') || undefined,
      timeZoneName: this.getAttribute('time-zone-name') || undefined,
    }).format(date);
  }

  connectedCallback() { // (2)
    if (!this.rendered) {
      this.render();
      this.rendered = true;
    }
  }

  static get observedAttributes() { // (3)
    return ['datetime', 'year', 'month', 'day', 'hour', 'minute', 'second', 'time-zone-name'];
  }

  attributeChangedCallback(name, oldValue, newValue) { // (4)
    this.render();
  }

}

customElements.define(&quot;time-formatted&quot;, TimeFormatted);
&lt;/script&gt;

&lt;time-formatted id=&quot;elem&quot; hour=&quot;numeric&quot; minute=&quot;numeric&quot; second=&quot;numeric&quot;&gt;&lt;/time-formatted&gt;

&lt;script&gt;
setInterval(() =&gt; elem.setAttribute('datetime', new Date()), 1000); // (5)
&lt;/script&gt;</code></pre>
        </div>
      </div>
      <div class="code-result code-example__result">
          <iframe
            class="code-result__iframe"
            name="test-i4bsed8gfk"
            style="height:50px"
            src="about:blank"></iframe>
        </div>
      </div><ol>
<li>The rendering logic is moved to <code>render()</code> helper method.</li>
<li>We call it once when the element is inserted into page.</li>
<li>For a change of an attribute, listed in <code>observedAttributes()</code>, <code>attributeChangedCallback</code> triggers.</li>
<li>…and re-renders the element.</li>
<li>At the end, we can easily make a live timer.</li>
</ol>
<h2><a class="main__anchor" name="rendering-order" href="#rendering-order">Rendering order</a></h2><p>When HTML parser builds the DOM, elements are processed one after another, parents before children. E.g. if we have <code>&lt;outer&gt;&lt;inner&gt;&lt;/inner&gt;&lt;/outer&gt;</code>, then <code>&lt;outer&gt;</code> element is created and connected to DOM first, and then <code>&lt;inner&gt;</code>.</p>
<p>That leads to important consequences for custom elements.</p>
<p>For example, if a custom element tries to access <code>innerHTML</code> in <code>connectedCallback</code>, it gets nothing:</p>
<div id="fitq8pobv4" data-trusted="1" class="code-example" data-demo-height="40" data-highlight="[{&quot;start&quot;:10,&quot;end&quot;:10},{&quot;start&quot;:4,&quot;end&quot;:4}]">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code>&lt;script&gt;
customElements.define('user-info', class extends HTMLElement {

  connectedCallback() {
    alert(this.innerHTML); // empty (*)
  }

});
&lt;/script&gt;

&lt;user-info&gt;John&lt;/user-info&gt;</code></pre>
        </div>
      </div>
      
      </div><p>If you run it, the <code>alert</code> is empty.</p>
<p>That’s exactly because there are no children on that stage, the DOM is unfinished. HTML parser connected the custom element <code>&lt;user-info&gt;</code>, and is going to proceed to its children, but just didn’t yet.</p>
<p>If we’d like to pass information to custom element, we can use attributes. They are available immediately.</p>
<p>Or, if we really need the children, we can defer access to them with zero-delay <code>setTimeout</code>.</p>
<p>This works:</p>
<div id="rrs38ovjhe" data-trusted="1" class="code-example" data-demo-height="40" data-highlight="[{&quot;start&quot;:10,&quot;end&quot;:10},{&quot;start&quot;:4,&quot;end&quot;:4}]">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code>&lt;script&gt;
customElements.define('user-info', class extends HTMLElement {

  connectedCallback() {
    setTimeout(() =&gt; alert(this.innerHTML)); // John (*)
  }

});
&lt;/script&gt;

&lt;user-info&gt;John&lt;/user-info&gt;</code></pre>
        </div>
      </div>
      
      </div><p>Now the <code>alert</code> in line <code>(*)</code> shows “John”, as we run it asynchronously, after the HTML parsing is complete. We can process children if needed and finish the initialization.</p>
<p>On the other hand, this solution is also not perfect. If nested custom elements also use <code>setTimeout</code> to initialize themselves, then they queue up: the outer <code>setTimeout</code> triggers first, and then the inner one.</p>
<p>So the outer element finishes the initialization before the inner one.</p>
<p>Let’s demonstrate that on example:</p>
<div id="i9eiz8k5vp" data-trusted="1" class="code-example" data-demo-height="0" data-highlight="[{&quot;start&quot;:9,&quot;end&quot;:11}]">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code>&lt;script&gt;
customElements.define('user-info', class extends HTMLElement {
  connectedCallback() {
    alert(`${this.id} connected.`);
    setTimeout(() =&gt; alert(`${this.id} initialized.`));
  }
});
&lt;/script&gt;

&lt;user-info id=&quot;outer&quot;&gt;
  &lt;user-info id=&quot;inner&quot;&gt;&lt;/user-info&gt;
&lt;/user-info&gt;</code></pre>
        </div>
      </div>
      
      </div><p>Output order:</p>
<ol>
<li>outer connected.</li>
<li>inner connected.</li>
<li>outer initialized.</li>
<li>inner initialized.</li>
</ol>
<p>We can clearly see that the outer element finishes initialization <code>(3)</code> before the inner one <code>(4)</code>.</p>
<p>There’s no built-in callback that triggers after nested elements are ready. If needed, we can implement such thing on our own. For instance, inner elements can dispatch events like <code>initialized</code>, and outer ones can listen and react on them.</p>
<h2><a class="main__anchor" name="customized-built-in-elements" href="#customized-built-in-elements">Customized built-in elements</a></h2><p>New elements that we create, such as <code>&lt;time-formatted&gt;</code>, don’t have any associated semantics. They are unknown to search engines, and accessibility devices can’t handle them.</p>
<p>But such things can be important. E.g, a search engine would be interested to know that we actually show a time. And if we’re making a special kind of button, why not reuse the existing <code>&lt;button&gt;</code> functionality?</p>
<p>We can extend and customize built-in HTML elements by inheriting from their classes.</p>
<p>For example, buttons are instances of <code>HTMLButtonElement</code>, let’s build upon it.</p>
<ol>
<li>
<p>Extend <code>HTMLButtonElement</code> with our class:</p>
<div id="1bnuqat023" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>class HelloButton extends HTMLButtonElement { /* custom element methods */ }</code></pre>
        </div>
      </div>
      
      </div></li>
<li>
<p>Provide the third argument to <code>customElements.define</code>, that specifies the tag:</p>
<div id="5beeb63eon" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:0,&quot;cols&quot;:[{&quot;start&quot;:51,&quot;end&quot;:70}]}]">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>customElements.define('hello-button', HelloButton, {extends: 'button'});</code></pre>
        </div>
      </div>
      
      </div><p>There may be different tags that share the same DOM-class, that’s why specifying <code>extends</code> is needed.</p>
</li>
<li>
<p>At the end, to use our custom element, insert a regular <code>&lt;button&gt;</code> tag, but add <code>is=&quot;hello-button&quot;</code> to it:</p>
<div id="6efqfqptiv" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code>&lt;button is=&quot;hello-button&quot;&gt;...&lt;/button&gt;</code></pre>
        </div>
      </div>
      
      </div></li>
</ol>
<p>Here’s a full example:</p>
<div id="rf96ggv7eu" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:14,&quot;end&quot;:14},{&quot;start&quot;:12,&quot;end&quot;:12},{&quot;start&quot;:9,&quot;end&quot;:9},{&quot;start&quot;:3,&quot;end&quot;:3}]" data-autorun="no-epub">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code>&lt;script&gt;
// The button that says &quot;hello&quot; on click
class HelloButton extends HTMLButtonElement {
  constructor() {
    super();
    this.addEventListener('click', () =&gt; alert(&quot;Hello!&quot;));
  }
}

customElements.define('hello-button', HelloButton, {extends: 'button'});
&lt;/script&gt;

&lt;button is=&quot;hello-button&quot;&gt;Click me&lt;/button&gt;

&lt;button is=&quot;hello-button&quot; disabled&gt;Disabled&lt;/button&gt;</code></pre>
        </div>
      </div>
      <div class="code-result code-example__result">
          <iframe
            class="code-result__iframe"
            name="test-rf96ggv7eu"
            style="height:200px"
            src="about:blank"></iframe>
        </div>
      </div><p>Our new button extends the built-in one. So it keeps the same styles and standard features like <code>disabled</code> attribute.</p>
<h2><a class="main__anchor" name="references" href="#references">References</a></h2><ul>
<li>HTML Living Standard: <a href="https://html.spec.whatwg.org/#custom-elements">https://html.spec.whatwg.org/#custom-elements</a>.</li>
<li>Compatiblity: <a href="https://caniuse.com/#feat=custom-elementsv1">https://caniuse.com/#feat=custom-elementsv1</a>.</li>
</ul>
<h2><a class="main__anchor" name="summary" href="#summary">Summary</a></h2><p>Custom elements can be of two types:</p>
<ol>
<li>
<p>“Autonomous” – new tags, extending <code>HTMLElement</code>.</p>
<p>Definition scheme:</p>
<div id="901l78bczw" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>class MyElement extends HTMLElement {
  constructor() { super(); /* ... */ }
  connectedCallback() { /* ... */ }
  disconnectedCallback() { /* ... */  }
  static get observedAttributes() { return [/* ... */]; }
  attributeChangedCallback(name, oldValue, newValue) { /* ... */ }
  adoptedCallback() { /* ... */ }
 }
customElements.define('my-element', MyElement);
/* &lt;my-element&gt; */</code></pre>
        </div>
      </div>
      
      </div></li>
<li>
<p>“Customized built-in elements” – extensions of existing elements.</p>
<p>Requires one more <code>.define</code> argument, and <code>is=&quot;...&quot;</code> in HTML:</p>
<div id="btbav0f0db" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>class MyButton extends HTMLButtonElement { /*...*/ }
customElements.define('my-button', MyElement, {extends: 'button'});
/* &lt;button is=&quot;my-button&quot;&gt; */</code></pre>
        </div>
      </div>
      
      </div></li>
</ol>
<p>Custom elements are well-supported among browsers. There’s a polyfill <a href="https://github.com/webcomponents/polyfills/tree/master/packages/webcomponentsjs">https://github.com/webcomponents/polyfills/tree/master/packages/webcomponentsjs</a>.</p>
</div></article><div class="tasks formatted"><h2 class="tasks__title" id="tasks"><a class="tasks__title-anchor main__anchor main__anchor main__anchor_noicon" href="#tasks">Tasks</a></h2><div class="task tasks__task"><div class="task__header"><div class="task__title-wrap"><h3 class="task__title"><a class="main__anchor" href="#live-timer-element" name="live-timer-element">Live timer element</a></h3><a class="task__open-link" href="/task/live-timer" target="_blank"></a></div><div class="task__header-note"></div><div class="task__content"><div class="task__formatted"><p>We already have <code>&lt;time-formatted&gt;</code> element to show a nicely formatted time.</p>
<p>Create <code>&lt;live-timer&gt;</code> element to show the current time:</p>
<ol>
<li>It should use <code>&lt;time-formatted&gt;</code> internally, not duplicate its functionality.</li>
<li>Ticks (updates) every second.</li>
<li>For every tick, a custom event named <code>tick</code> should be generated, with the current date in <code>event.detail</code> (see chapter <a href="/dispatch-events">Dispatching custom events</a>).</li>
</ol>
<p>Usage:</p>
<div id="o21aux5cda" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code>&lt;live-timer id=&quot;elem&quot;&gt;&lt;/live-timer&gt;

&lt;script&gt;
  elem.addEventListener('tick', event =&gt; console.log(event.detail));
&lt;/script&gt;</code></pre>
        </div>
      </div>
      
      </div><p>Demo:</p>
<div class="code-result">
    <div class="code-result__toolbar toolbar"></div>
    <iframe class="code-result__iframe" data-trusted="1" style="height:40px" src="https://en.js.cx/task/live-timer/solution/"></iframe>
  </div><p><a href="https://plnkr.co/edit/XOf4WbLRLApuuYmr?p=preview" target="_blank" data-plunk-id="XOf4WbLRLApuuYmr">Open a sandbox for the task.</a></p></div><button class="task__solution" type="button">solution</button><div class="task__answer"><div class="task__answer-content"><div class="formatted"><p>Please note:</p>
<ol>
<li>We clear <code>setInterval</code> timer when the element is removed from the document. That’s important, otherwise it continues ticking even if not needed any more. And the browser can’t clear the memory from this element and referenced by it.</li>
<li>We can access current date as <code>elem.date</code> property. All class methods and properties are naturally element methods and properties.</li>
</ol>
<p><a href="https://plnkr.co/edit/5A1yvhPjyH9RbdoX?p=preview" target="_blank" data-plunk-id="5A1yvhPjyH9RbdoX">Open the solution in a sandbox.</a></p></div></div><button class="close-button task__answer-close" type="button" title="close"></button></div></div></div></div></div></div><div class="page__nav-wrap"><a class="page__nav page__nav_prev" href="/webcomponents-intro" data-tooltip="From the orbital height"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Previous lesson</span></a><a class="page__nav page__nav_next" href="/shadow-dom" data-tooltip="Shadow DOM"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Next lesson</span></a></div><div class="article-tablet-foot tablet-only"><div class="article-tablet-foot__layout"><div class="share-icons"><span class="share-icons__title">Share</span><a class="share share_tw" href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fcustom-elements" rel="nofollow"></a><a class="share share_fb" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjavascript.info%2Fcustom-elements" rel="nofollow"></a></div><div class="article-tablet-foot__map"><a class="map" href="/tutorial/map" data-action="tutorial-map"><span class="map__text">Tutorial map</span></a></div></div></div><div class="comments formatted" id="comments"><div class="comments__header"><h2 class="comments__header-title"><a href="#comments" name="comments">Comments</a></h2><div class="comments__read-before"><span class="comments__read-before-link">read this before commenting…</span><div class="comments__read-before-popup"><div class="comments__read-before-popup-i"><ul><li>If you have suggestions what to improve - please <a href="https://github.com/javascript-tutorial/en.javascript.info/issues/new">submit a GitHub issue</a> or a pull request instead of commenting.</li><li>If you can't understand something in the article – please elaborate.</li><li>To insert few words of code, use the <code>&lt;code&gt;</code> tag, for several lines – wrap them in <code>&lt;pre&gt;</code> tag, for more than 10 lines – use a sandbox (<a href='https://plnkr.co/edit/?p=preview'>plnkr</a>, <a href='https://jsbin.com'>jsbin</a>, <a href='http://codepen.io'>codepen</a>…)</li></ul></div></div></div></div><div id="disqus_thread"></div><script>var disqus_config = function() { if (!this.page) this.page = {}; Object.assign(this.page, {"url":"https:\/\/javascript.info\/custom-elements","identifier":"\/custom-elements"}); };</script><script>var disqus_shortname = "javascriptinfo";</script><script>var disqus_enabled = true;</script></div></main></div><div class="sidebar page__sidebar sidebar sidebar_sticky-footer"><button class="sidebar__toggle" data-sidebar-toggle></button><a class="map" href="/tutorial/map" data-action="tutorial-map" data-tooltip="Tutorial map"></a><div class="sidebar__inner"><div class="sidebar__content"><div class="sidebar__section"><h4 class="sidebar__section-title">Chapter</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a class="sidebar__link" href="/web-components">Web components</a></li></ul></nav></div><div class="sidebar__section"><h4 class="sidebar__section-title">Lesson navigation</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a class="sidebar__link" href="#example-time-formatted">Example: “time-formatted”</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#observing-attributes">Observing attributes</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#rendering-order">Rendering order</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#customized-built-in-elements">Customized built-in elements</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#references">References</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#summary">Summary</a></li></ul></nav></div><div class="sidebar__section"><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a class="sidebar__link" href="#tasks">Tasks (1)</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#comments">Comments</a></li></ul></nav></div><div class="sidebar__section"><div class="sidebar__section-title">Share</div><a class="share share_tw sidebar__share" href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fcustom-elements" rel="nofollow"></a><a class="share share_fb sidebar__share" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fjavascript.info%2Fcustom-elements" rel="nofollow"></a></div><div class="sidebar__section"><a class="sidebar__link" href="https://github.com/javascript-tutorial/en.javascript.info/blob/master/8-web-components/2-custom-elements" rel="nofollow">Edit on GitHub</a></div><div class="sidebar__section" id="sponsorBar"><div class="sidebar__section-title" id="sponsorBarTitle"></div><div id="sponsorBarContent"></div><script>window.initSponsorBar()</script></div></div></div></div></div></div><div class="page-footer"><ul class="page-footer__list"><li class="page-footer__item page-footer__item_copy">©&nbsp;2007—2021&nbsp; Ilya Kantor</li><li class="page-footer__item page-footer__item_about"><a class="page-footer__link" href="/about">about the project</a></li><li class="page-footer__item page-footer__item_contact"><a class="page-footer__link" href="/about#contact-us">contact us</a></li><li class="page-footer__item page-footer__item_terms"><a class="page-footer__link" href="/terms">terms of usage</a></li><li class="page-footer__item page-footer__item_privacy"><a class="page-footer__link" href="/privacy">privacy policy</a></li></ul></div></body></html>